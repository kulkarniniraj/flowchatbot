---

title: Flow Chatbot library API


keywords: fastai
sidebar: home_sidebar

summary: "A chatbot library to build bots like <a href='https://en.wikipedia.org/wiki/Flowchart'>flowchart</a>"
description: "A chatbot library to build bots like <a href='https://en.wikipedia.org/wiki/Flowchart'>flowchart</a>"
nb_path: "multiprocess-bot.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: multiprocess-bot.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Utils">Data Utils<a class="anchor-link" href="#Data-Utils"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_chained_data" class="doc_header"><code>get_chained_data</code><a href="https://github.com/kulkarniniraj/flowchatbot/tree/master/flowchatbot/flowchatbot.py#L14" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_chained_data</code>(<strong><code>data</code></strong>, <strong>*<code>keys</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="set_chained_data" class="doc_header"><code>set_chained_data</code><a href="https://github.com/kulkarniniraj/flowchatbot/tree/master/flowchatbot/flowchatbot.py#L22" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>set_chained_data</code>(<strong><code>data</code></strong>, <strong>*<code>keys</code></strong>, <strong><code>val</code></strong>=<em><code>0</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tryint" class="doc_header"><code>tryint</code><a href="https://github.com/kulkarniniraj/flowchatbot/tree/master/flowchatbot/flowchatbot.py#L32" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tryint</code>(<strong><code>x</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Chatbot-classes">Chatbot classes<a class="anchor-link" href="#Chatbot-classes"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CHAT_RET" class="doc_header"><code>CHAT_RET</code><a href="https://github.com/kulkarniniraj/flowchatbot/tree/master/flowchatbot/flowchatbot.py#L40" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Enum</code> = [STAY, NEXT]</p>
</blockquote>
<p>An enumeration.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Pipe" class="doc_header"><code>class</code> <code>Pipe</code><a href="https://github.com/kulkarniniraj/flowchatbot/tree/master/flowchatbot/flowchatbot.py#L45" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Pipe</code>(<strong><code>on_question</code></strong>=<em><code>None</code></em>, <strong><code>on_answer</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Segment" class="doc_header"><code>class</code> <code>Segment</code><a href="https://github.com/kulkarniniraj/flowchatbot/tree/master/flowchatbot/flowchatbot.py#L62" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Segment</code>(<strong><code>key</code></strong>, <strong><code>q</code></strong>, <strong><code>a</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/flowchatbot/multiprocess-bot.html#Pipe"><code>Pipe</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ValidatedSegment" class="doc_header"><code>class</code> <code>ValidatedSegment</code><a href="https://github.com/kulkarniniraj/flowchatbot/tree/master/flowchatbot/flowchatbot.py#L82" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ValidatedSegment</code>(<strong><code>key</code></strong>, <strong><code>q</code></strong>, <strong><code>a</code></strong>, <strong><code>errmsg</code></strong>, <strong><code>valid_fn</code></strong>) :: <a href="/flowchatbot/multiprocess-bot.html#Segment"><code>Segment</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiChoiceSegment" class="doc_header"><code>class</code> <code>MultiChoiceSegment</code><a href="https://github.com/kulkarniniraj/flowchatbot/tree/master/flowchatbot/flowchatbot.py#L96" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiChoiceSegment</code>(<strong><code>key</code></strong>, <strong><code>q</code></strong>, <strong><code>resp_lst</code></strong>, <strong><code>ans</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/flowchatbot/multiprocess-bot.html#Segment"><code>Segment</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ComputeSegment" class="doc_header"><code>class</code> <code>ComputeSegment</code><a href="https://github.com/kulkarniniraj/flowchatbot/tree/master/flowchatbot/flowchatbot.py#L112" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ComputeSegment</code>(<strong><code>key</code></strong>, <strong><code>q</code></strong>, <strong><code>a</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/flowchatbot/multiprocess-bot.html#Segment"><code>Segment</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Composite" class="doc_header"><code>class</code> <code>Composite</code><a href="https://github.com/kulkarniniraj/flowchatbot/tree/master/flowchatbot/flowchatbot.py#L117" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Composite</code>(<strong><code>key</code></strong>, <strong>*<code>args</code></strong>) :: <a href="/flowchatbot/multiprocess-bot.html#Pipe"><code>Pipe</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LoopComposite" class="doc_header"><code>class</code> <code>LoopComposite</code><a href="https://github.com/kulkarniniraj/flowchatbot/tree/master/flowchatbot/flowchatbot.py#L196" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LoopComposite</code>(<strong><code>key</code></strong>, <strong>*<code>args</code></strong>) :: <a href="/flowchatbot/multiprocess-bot.html#Composite"><code>Composite</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TextAdapter" class="doc_header"><code>class</code> <code>TextAdapter</code><a href="https://github.com/kulkarniniraj/flowchatbot/tree/master/flowchatbot/flowchatbot.py#L210" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TextAdapter</code>(<strong><code>root</code></strong>) :: <a href="/flowchatbot/multiprocess-bot.html#Pipe"><code>Pipe</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Test-segment-and-composite">Test segment and composite<a class="anchor-link" href="#Test-segment-and-composite"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span> <span class="o">=</span> <span class="n">TextAdapter</span><span class="p">(</span>
    <span class="n">Composite</span><span class="p">(</span>
        <span class="s1">&#39;c1&#39;</span><span class="p">,</span>
        <span class="n">Segment</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;welcome&#39;</span><span class="p">),</span>
         <span class="n">Composite</span><span class="p">(</span><span class="s1">&#39;c2&#39;</span><span class="p">,</span> 
            <span class="n">Segment</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="s1">&#39;your name&#39;</span><span class="p">,</span> <span class="s1">&#39;got it&#39;</span><span class="p">),</span>
            <span class="n">ValidatedSegment</span><span class="p">(</span><span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="s1">&#39;your phone number&#39;</span><span class="p">,</span> <span class="s1">&#39;got it&#39;</span><span class="p">,</span> 
                            <span class="s1">&#39;phone number should be 10 digits with optional +91 at beginning&#39;</span><span class="p">,</span>
                            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;(\+91)?\d</span><span class="si">{10}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">),</span>        
            <span class="n">Segment</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="s1">&#39;your email&#39;</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">)</span>
                  <span class="p">),</span>
        <span class="n">Composite</span><span class="p">(</span><span class="s1">&#39;c3&#39;</span><span class="p">,</span> 
            <span class="n">Segment</span><span class="p">(</span><span class="s1">&#39;s4&#39;</span><span class="p">,</span> <span class="s1">&#39;your income&#39;</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">)</span>
                 <span class="p">)</span>
        
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">bot</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">flushall</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;Niraj&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;123123&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;1231234567&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;asd@qwe&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;30000&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;Niraj&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;123123&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;1231234567&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;asd@qwe&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;30000&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Splitters">Splitters<a class="anchor-link" href="#Splitters"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Splitter" class="doc_header"><code>class</code> <code>Splitter</code><a href="https://github.com/kulkarniniraj/flowchatbot/tree/master/flowchatbot/flowchatbot.py#L230" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Splitter</code>(<strong><code>key</code></strong>, <strong>*<code>branches</code></strong>, <strong><code>decider_fn</code></strong>=<em><code>&lt;lambda&gt;</code></em>, <strong><code>default</code></strong>=<em><code>0</code></em>) :: <a href="/flowchatbot/multiprocess-bot.html#Pipe"><code>Pipe</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SkipSplitter" class="doc_header"><code>class</code> <code>SkipSplitter</code><a href="https://github.com/kulkarniniraj/flowchatbot/tree/master/flowchatbot/flowchatbot.py#L289" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SkipSplitter</code>(<strong><code>key</code></strong>, <strong><code>branch</code></strong>, <strong><code>decider_fn</code></strong>=<em><code>&lt;lambda&gt;</code></em>, <strong><code>default</code></strong>=<em><code>0</code></em>) :: <a href="/flowchatbot/multiprocess-bot.html#Splitter"><code>Splitter</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Test-splitters">Test splitters<a class="anchor-link" href="#Test-splitters"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">keys</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_fn</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;splitter decider&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;s4&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">tryint</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;s4&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">infodecider</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="c1">#     print(f&#39;decider {data}&#39;)</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">get_chained_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;ss1&#39;</span><span class="p">,</span> <span class="s1">&#39;c2&#39;</span><span class="p">,</span> <span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">val</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span> <span class="o">=</span> <span class="n">TextAdapter</span><span class="p">(</span>
    <span class="n">Composite</span><span class="p">(</span>
        <span class="s1">&#39;c1&#39;</span><span class="p">,</span>
        <span class="n">Segment</span><span class="p">(</span><span class="s1">&#39;s0&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;welcome&#39;</span><span class="p">),</span>
        <span class="n">SkipSplitter</span><span class="p">(</span><span class="s1">&#39;ss1&#39;</span><span class="p">,</span> 
                    <span class="n">Composite</span><span class="p">(</span><span class="s1">&#39;c2&#39;</span><span class="p">,</span> 
                        <span class="n">Segment</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="s1">&#39;your name&#39;</span><span class="p">,</span> <span class="s1">&#39;got it&#39;</span><span class="p">),</span>
                        <span class="n">ValidatedSegment</span><span class="p">(</span><span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="s1">&#39;your mobile&#39;</span><span class="p">,</span> <span class="s1">&#39;got it&#39;</span><span class="p">,</span> <span class="s1">&#39;10 digit mobile&#39;</span><span class="p">,</span>
                                    <span class="n">valid_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;(\+91)?\d</span><span class="si">{10}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">),</span>
                        <span class="n">ValidatedSegment</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="s1">&#39;your email&#39;</span><span class="p">,</span> <span class="s1">&#39;got it&#39;</span><span class="p">,</span> <span class="s1">&#39;email in format abc@qwe.zxc&#39;</span><span class="p">,</span>
                                    <span class="n">valid_fn</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;[a-zA-Z0-9._]+@[a-zA-Z0-9_]+\.[a-zA-Z0-9._]+&#39;</span><span class="p">,</span> 
                                                                <span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="p">),</span>
                    <span class="n">decider_fn</span><span class="o">=</span> <span class="n">infodecider</span><span class="p">),</span>
        <span class="n">Segment</span><span class="p">(</span><span class="s1">&#39;s4&#39;</span><span class="p">,</span> <span class="s1">&#39;your income&#39;</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">),</span>
        <span class="n">Splitter</span><span class="p">(</span><span class="s1">&#39;s5&#39;</span><span class="p">,</span> 
                <span class="n">Segment</span><span class="p">(</span><span class="s1">&#39;s51&#39;</span><span class="p">,</span> <span class="s1">&#39;Do you have bike?&#39;</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">),</span>
                <span class="n">Segment</span><span class="p">(</span><span class="s1">&#39;s52&#39;</span><span class="p">,</span> <span class="s1">&#39;Do you have car?&#39;</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">),</span>
                <span class="n">decider_fn</span><span class="o">=</span><span class="n">test_fn</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">bot</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">flushall</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;hi&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>composite answer current s0 data {&#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;11000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s52&#39;, &#39;s52&#39;: {&#39;data&#39;: &#39;No&#39;}}, &#39;pos&#39;: &#39;s0&#39;}
composite question current ss1 data {&#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;11000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s52&#39;, &#39;s52&#39;: {&#39;data&#39;: &#39;No&#39;}}, &#39;pos&#39;: &#39;ss1&#39;}
skip question data {&#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;11000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s52&#39;, &#39;s52&#39;: {&#39;data&#39;: &#39;No&#39;}}, &#39;pos&#39;: &#39;ss1&#39;}
adapter data {&#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;11000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s52&#39;, &#39;s52&#39;: {&#39;data&#39;: &#39;No&#39;}}, &#39;pos&#39;: &#39;s4&#39;}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;welcome\nyour income&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;Niraj&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>composite answer current ss1 data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s1&#39;, &#39;s1&#39;: {}}}}
skip answer data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s1&#39;, &#39;s1&#39;: {}}}}
composite answer current s1 data {&#39;pos&#39;: &#39;s1&#39;, &#39;s1&#39;: {}}
composite question current ss1 data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s2&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}}}}
skip question data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s2&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}}}}
composite question current s2 data {&#39;pos&#39;: &#39;s2&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}}
adapter data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s2&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {}}}}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;got it\nyour mobile&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;123123&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>composite answer current ss1 data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s2&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {}}}}
skip answer data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s2&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {}}}}
composite answer current s2 data {&#39;pos&#39;: &#39;s2&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {}}
composite question current ss1 data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s2&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;&#39;}}}}
skip question data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s2&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;&#39;}}}}
composite question current s2 data {&#39;pos&#39;: &#39;s2&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;&#39;}}
adapter data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s2&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;&#39;}}}}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;10 digit mobile\nyour mobile&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;1231234567&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>composite answer current ss1 data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s2&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;&#39;}}}}
skip answer data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s2&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;&#39;}}}}
composite answer current s2 data {&#39;pos&#39;: &#39;s2&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;&#39;}}
composite question current ss1 data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s3&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}}}}
skip question data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s3&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}}}}
composite question current s3 data {&#39;pos&#39;: &#39;s3&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}}
adapter data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s3&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {}}}}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;got it\nyour email&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;asd@qwe&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>composite answer current ss1 data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s3&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {}}}}
skip answer data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s3&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {}}}}
composite answer current s3 data {&#39;pos&#39;: &#39;s3&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {}}
composite question current ss1 data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s3&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;&#39;}}}}
skip question data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s3&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;&#39;}}}}
composite question current s3 data {&#39;pos&#39;: &#39;s3&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;&#39;}}
adapter data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s3&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;&#39;}}}}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;email in format abc@qwe.zxc\nyour email&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;asd@qwe.com&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>composite answer current ss1 data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s3&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;&#39;}}}}
skip answer data {&#39;pos&#39;: &#39;ss1&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;pos&#39;: &#39;s3&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;&#39;}}}}
composite answer current s3 data {&#39;pos&#39;: &#39;s3&#39;, &#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;&#39;}}
composite question current s4 data {&#39;pos&#39;: &#39;s4&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}}
adapter data {&#39;pos&#39;: &#39;s4&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {}}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;got it\nyour income&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;9000&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>composite answer current s4 data {&#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;11000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s52&#39;, &#39;s52&#39;: {&#39;data&#39;: &#39;No&#39;}}, &#39;pos&#39;: &#39;s4&#39;}
composite question current s5 data {&#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;9000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s52&#39;, &#39;s52&#39;: {&#39;data&#39;: &#39;No&#39;}}, &#39;pos&#39;: &#39;s5&#39;}
splitter question data {&#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;9000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s52&#39;, &#39;s52&#39;: {&#39;data&#39;: &#39;No&#39;}}, &#39;pos&#39;: &#39;s5&#39;}
splitter decider {&#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;9000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s52&#39;, &#39;s52&#39;: {&#39;data&#39;: &#39;No&#39;}}, &#39;pos&#39;: &#39;s5&#39;} 9000
decider s5 0
splitter question data after pos set s5 s51 {&#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;9000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s51&#39;, &#39;s52&#39;: {&#39;data&#39;: &#39;No&#39;}}, &#39;pos&#39;: &#39;s5&#39;}
adapter data {&#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;9000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s51&#39;, &#39;s52&#39;: {&#39;data&#39;: &#39;No&#39;}, &#39;s51&#39;: {}}, &#39;pos&#39;: &#39;s5&#39;}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;ok\nDo you have bike?&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>composite answer current s5 data {&#39;pos&#39;: &#39;s5&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;11000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s52&#39;, &#39;s52&#39;: {}}}
splitter answer data {&#39;pos&#39;: &#39;s5&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;11000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s52&#39;, &#39;s52&#39;: {}}}
splitter decider {&#39;pos&#39;: &#39;s5&#39;, &#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;11000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s52&#39;, &#39;s52&#39;: {}}} 11000
decider s5 1
composite question current s0 data {&#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;11000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s52&#39;, &#39;s52&#39;: {&#39;data&#39;: &#39;No&#39;}}, &#39;pos&#39;: &#39;s0&#39;}
adapter data {&#39;s0&#39;: {&#39;data&#39;: &#39;hi&#39;}, &#39;ss1&#39;: {&#39;pos&#39;: &#39;c2&#39;, &#39;c2&#39;: {&#39;s1&#39;: {&#39;data&#39;: &#39;Niraj&#39;}, &#39;s2&#39;: {&#39;data&#39;: &#39;1231234567&#39;}, &#39;s3&#39;: {&#39;data&#39;: &#39;asd@qwe.com&#39;}}}, &#39;s4&#39;: {&#39;data&#39;: &#39;11000&#39;}, &#39;s5&#39;: {&#39;pos&#39;: &#39;s52&#39;, &#39;s52&#39;: {&#39;data&#39;: &#39;No&#39;}}, &#39;pos&#39;: &#39;s0&#39;}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;ok\n&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;ok&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bot</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">()</span>
<span class="n">r</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">session_id</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">expire</span><span class="p">(</span><span class="n">session_id</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">session_id</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;(\+91)?\d</span><span class="si">{10}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;+911231231231&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install redis
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Build-Lib">Build Lib<a class="anchor-link" href="#Build-Lib"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span> 
<span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted multiprocess-bot.ipynb.
Converted oil-crm.ipynb.
Converted scratchpad.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

